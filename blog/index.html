<!doctype html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Salmon's blog</title>
		<meta name="author" content="Salmon" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="HandheldFriendly" content="true" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
		
		<link href="_plugins/resetCSS.css" type="text/css" rel="stylesheet" />
		<link href="_plugins/template/markdown-github.css" type="text/css" rel="stylesheet" />
		<link href="_plugins/template/salmon.css" type="text/css" rel="stylesheet" />
    
		<script src="_plugins/jquery-2.1.1.min.js"></script>
		<script src="_plugins/async.min.js"></script>
		<script src="_plugins/marked.min.js"></script>
		<script src="_plugins/salmon.js"></script>
	</head>

	<body>
		<div class='header'>
		</div>

		<article class='content'>
			<div class='article hide'>
				<a class='title'><span>Aritcle_title</span></a>
				<span class='time'>Date_and_time</span>
				<span class='tags'>Tags</span>
			</div>
		</article>

		<div class='footer'>
		</div>

		<script>
			// Load 'header.html' and 'footer.html'.
			$('.header').load('_static/header.html');
			$('.footer').load('_static/footer.html');
			// Choose the CSS template.
			$('.content').addClass('markdown-body');
			//
			async.waterfall([
				// Get the info of all articles.
				function (callback) {
					getArticlesInfo(function (articles) {
						callback(null, articles);
					});
				},
				// Replace the content.
				function (articles, callback) {
					var title = getParameterByName('title');
					getArticleByTitle(title, function (isExist, markdownToHTML) {
						if (isExist)
							$('.content').html(markdownToHTML);
						else {
							articles.forEach(function (article) {
								console.log(article.title);
								var clone = $('.content .article.hide').clone().removeClass('hide');
								clone.appendTo($('.content'));
								clone.find('a.title').attr('href', 'index.html?title=' + article.url);
								clone.find('a.title span').html(article.title);
								clone.find('span.tags').html(article.tags);
							});
						}
						callback(null);
					});
				}
			], function (err) {

			});
		</script>
	</body>
</html>